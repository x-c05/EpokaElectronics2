<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Product · Epoka Electronics</title>
  <link rel="stylesheet" href="/css/styles.css" />
</head>
<body>
  <div class="topbar">
    <div class="container">
      <div class="nav">
        <a class="brand" href="/">
           <img class="logo" src="/assets/logo/Epoka Electronics.png" alt="">
          <div>Epoka Electronics</div>
        </a>
        <div class="nav-actions">
          <a class="btn secondary" href="/cart.html">Cart <span class="badge" data-cartcount>0</span></a>
          <div data-account></div>
        </div>
      </div>
    </div>
  </div>

  <div class="container" style="padding:18px 0 34px">
    <div class="card" style="padding:18px">
      <div class="two" style="padding:0; align-items:start">
        <div>
          <img id="img" src="/assets/products/phone-1.svg" style="width:100%; height:360px; object-fit:cover; border-radius:18px; border:1px solid rgba(255,255,255,.08)" />
        </div>
        <div>
          <div class="badge" id="cat"></div>
          <h2 style="margin:10px 0 6px" id="name"></h2>
          <div class="muted" id="brand" style="margin-bottom:12px"></div>
          <div style="display:flex; gap:10px; align-items:center; margin: 14px 0 18px">
            <div class="price" id="price" style="font-size:22px"></div>
            <div class="badge" id="stock"></div>
          </div>
          <div class="notice" id="desc"></div>
          <div style="display:flex; gap:10px; margin-top:14px; align-items:center">
            <input class="textbox" id="qty" type="number" min="1" value="1" style="max-width:140px" />
            <button class="btn" id="add">Add to cart</button>
            <a class="btn secondary" href="/">Back</a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="toast"></div>
  <script src="/js/app.js"></script>
  <script>
    function getId() {
      const u = new URL(location.href);
      return parseInt(u.searchParams.get("id") || "0");
    }

    (async () => {
      const id = getId();
      if (!id) { location.href = "/"; return; }
      try {
        const p = await Api.getProduct(id);
        document.getElementById("img").src = p.imageUrl || "/assets/products/phone-1.svg";
        document.getElementById("cat").textContent = p.categoryName;
        document.getElementById("name").textContent = p.name;
        document.getElementById("brand").textContent = p.brand ? `Brand: ${p.brand}` : "Brand: —";
        document.getElementById("price").textContent = Ui.money(p.price);
        document.getElementById("stock").textContent = p.stock > 0 ? `${p.stock} in stock` : "Out of stock";
        document.getElementById("desc").textContent = p.description || "No description provided.";
        document.getElementById("add").onclick = () => {
          const qty = Math.max(1, parseInt(document.getElementById("qty").value || "1"));
          if (p.stock <= 0) { Ui.toast("Unavailable", "This product is out of stock."); return; }
          Ui.addToCart(p, qty);
        };
      } catch (e) {
        Ui.toast("Error", e.message);
      }
    })();
  </script>
</body>
</html>
