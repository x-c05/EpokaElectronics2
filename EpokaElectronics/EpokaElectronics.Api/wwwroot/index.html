<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Epoka Electronics</title>
  <link rel="stylesheet" href="/css/styles.css" />
</head>
<body>
  <div class="topbar">
    <div class="container">
      <div class="nav">
        <a class="brand" href="/">
          <img class="logo" src="/assets/logo/Epoka Electronics.png" alt="">
          <div>Epoka Electronics</div>
        </a>

        <div class="nav-actions">
          <div class="pill">
            <input class="input" id="searchBox" placeholder="Search products, brands, SKU..." />
          </div>
          <a class="btn secondary" href="/cart.html">Cart <span class="badge" data-cartcount>0</span></a>
          <div data-account></div>
        </div>
      </div>
    </div>
  </div>

  <div class="container hero">
    <div class="hero-grid">
      <div class="card hero-main">
        <h1 class="h1">Best affordable electronics in the market ;)</h1>
        <p class="sub">Epoka Electronics is a modern online store offering quality electronic devices with a fast, simple, and secure shopping experience.</p>
        <div class="filters">
          <select class="select" id="categorySelect"></select>
          <select class="select" id="featuredSelect">
            <option value="">All products</option>
            <option value="true">Featured</option>
          </select>
          <button class="btn secondary" id="clearFilters">Reset</button>
          <a class="btn" href="/admin.html" data-admin style="display:none">Admin</a>
        </div>
        <div id="products" class="grid"></div>
      </div>

      <div class="card hero-side">
        <div class="kpi"><b>Ndërtuar nga:</b><span>Xhevdet Cekaj, Eduard Jukaj, Aldis Saliasi, Glen Sharka</span></div>
        <div class="kpi"><b>Follow us on:</b></div>
        <div class="kpi"><a href="https://www.instagram.com/epokauniversity/" target="_blank" aria-label="Instagram">
  <svg width="26" height="26" viewBox="0 0 24 24" fill="currentColor">
    <path d="M7.75 2C4.574 2 2 4.574 2 7.75v8.5C2 19.426 4.574 22 7.75 22h8.5C19.426 22 22 19.426 22 16.25v-8.5C22 4.574 19.426 2 16.25 2h-8.5zm0 2h8.5A3.75 3.75 0 0 1 20 7.75v8.5A3.75 3.75 0 0 1 16.25 20h-8.5A3.75 3.75 0 0 1 4 16.25v-8.5A3.75 3.75 0 0 1 7.75 4zm9.5 1.75a1 1 0 1 0 0 2 1 1 0 0 0 0-2zM12 7a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 2a3 3 0 1 1 0 6 3 3 0 0 1 0-6z"/>
  </svg>
  <a href="https://www.facebook.com/UniEpoka/" target="_blank" aria-label="Facebook">
  <svg width="26" height="26" viewBox="0 0 24 24" fill="currentColor">
    <path d="M22 12a10 10 0 1 0-11.563 9.876v-6.987H7.898V12h2.539V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.459h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.889h-2.33v6.987A10.002 10.002 0 0 0 22 12z"/>
  </svg>
  <a href="https://www.youtube.com/@epokachannel" target="_blank" aria-label="YouTube">
  <svg width="26" height="26" viewBox="0 0 24 24" fill="currentColor">
    <path d="M21.582 6.186a2.77 2.77 0 0 0-1.948-1.962C17.88 3.75 12 3.75 12 3.75s-5.88 0-7.634.474a2.77 2.77 0 0 0-1.948 1.962A29.94 29.94 0 0 0 2 12a29.94 29.94 0 0 0 .418 5.814 2.77 2.77 0 0 0 1.948 1.962C6.12 20.25 12 20.25 12 20.25s5.88 0 7.634-.474a2.77 2.77 0 0 0 1.948-1.962A29.94 29.94 0 0 0 22 12a29.94 29.94 0 0 0-.418-5.814zM9.75 15.5v-7l6 3.5-6 3.5z"/>
  </svg>
</a>

</a>
</a>
</b></div>
        <div class="notice">
          <div><b>Admin login</b></div>
          <div class="muted" style="margin-top:6px">Email: admin@epoka-electronics.com</div>
          <div class="muted">Password: Admin123!</div>
        </div>
      </div>
    </div>
  </div>

  <div class="container footer">
    <div>© <span id="year"></span> Epoka Electronics, Worked By: Xhevdet Cekaj, Eduard Jukaj, Glen Sharka, Aldis Saliasi. Accepted By: Ervis Trupja</div>
  </div>

  <div class="toast"></div>

  <script src="/js/app.js"></script>
  <script>
    const state = { categories: [], products: [], categoryId: "", featured: "", q: "" };

    async function loadCategories() {
      const categories = await Api.getCategories();
      state.categories = categories;
      const sel = document.getElementById("categorySelect");
      sel.innerHTML = `<option value="">All categories</option>` + categories.map(c => `<option value="${c.id}">${Ui.escapeHtml(c.name)}</option>`).join("");
      sel.onchange = () => { state.categoryId = sel.value; refresh(); };
    }

    async function loadProducts() {
      const params = {};
      if (state.categoryId) params.categoryId = state.categoryId;
      if (state.featured) params.featured = state.featured;
      if (state.q) params.q = state.q;
      const products = await Api.getProducts(params);
      state.products = products;
      renderProducts(products);
    }

    function renderProducts(items) {
      const el = document.getElementById("products");
      el.innerHTML = items.map(p => `
        <div class="card product">
          <a href="/product.html?id=${p.id}">
            <img src="${p.imageUrl || "/assets/products/phone-1.svg"}" alt="">
          </a>
          <div class="pbody">
            <p class="pname">${Ui.escapeHtml(p.name)}</p>
            <p class="pmeta">${Ui.escapeHtml(p.categoryName)} · ${Ui.escapeHtml(p.brand || "—")}</p>
            <div class="price-row">
              <div class="price">${Ui.money(p.price)}</div>
              <button class="btn secondary" data-add="${p.id}">Add</button>
            </div>
          </div>
        </div>
      `).join("");

      el.querySelectorAll("[data-add]").forEach(btn => {
        btn.onclick = () => {
          const id = parseInt(btn.getAttribute("data-add"));
          const p = items.find(x => x.id === id);
          if (!p) return;
          Ui.addToCart({ id: p.id, name: p.name, price: p.price, imageUrl: p.imageUrl }, 1);
        };
      });
    }

    function wireSearch() {
      const box = document.getElementById("searchBox");
      let t;
      box.addEventListener("input", () => {
        clearTimeout(t);
        t = setTimeout(() => {
          state.q = box.value.trim();
          refresh();
        }, 250);
      });

      const featured = document.getElementById("featuredSelect");
      featured.onchange = () => { state.featured = featured.value; refresh(); };

      document.getElementById("clearFilters").onclick = () => {
        state.categoryId = "";
        state.featured = "";
        state.q = "";
        document.getElementById("categorySelect").value = "";
        document.getElementById("featuredSelect").value = "";
        document.getElementById("searchBox").value = "";
        refresh();
      };
    }

    async function refresh() {
      try { await loadProducts(); }
      catch (e) { Ui.toast("Error", e.message); }
    }

    (async () => {
      document.getElementById("year").textContent = new Date().getFullYear();
      wireSearch();
      try {
        await loadCategories();
        await refresh();
      } catch (e) {
        Ui.toast("Backend not reachable", "Run the ASP.NET API and refresh this page.");
      }
    })();
  </script>
</body>
</html>
